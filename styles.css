:root{
  --bg:#0b1220; --panel:#0e1628cc; --text:#d7e0ff; --muted:#9aa7c7;
  --accent:#9d7dff; --accent2:#a8ffbf; --shadow:0 10px 30px rgba(0,0,0,0.35);

  /* Градиенты фона (по умолчанию) */
  --bg-grad1: rgba(168,255,191,0.18);
  --bg-grad2: rgba(119,199,255,0.14);
  --bg-grad3: rgba(182,166,255,0.10);

  /* HUD по умолчанию */
  --hud-bg: rgba(15,23,42,0.90);
  --hud-border: rgba(255,255,255,0.15);
  --hud-space: 80px; /* будет перезаписано из JS реальной высотой HUD */

  /* Аккордеон (дефолт) */
  --acc-border: rgba(154,167,199,0.35);
  --acc-bg: rgba(13,23,42,0.88);
  --acc-hover-bg: var(--accent2);
  --acc-hover-text:#001d00;
  --acc-content-bg: rgba(168,255,191,0.07);
}

/* ТЕМЫ */
[data-theme="calm"]{
  --bg:#0a1320; --panel:#0d172acc; --text:#dfe8ff; --muted:#a7b6d6;
  --wave1:#8fe3cf; --wave2:#77c7ff; --wave3:#b6a6ff; --wave4:#a8ffbf;

  --bg-grad1: rgba(168,255,191,0.18);
  --bg-grad2: rgba(119,199,255,0.14);
  --bg-grad3: rgba(182,166,255,0.10);

  --hud-bg: rgba(13,23,42,0.92);
  --hud-border: rgba(223,232,255,0.14);

  --acc-border: rgba(167,182,214,0.35);
  --acc-bg: rgba(13,23,42,0.88);
  --acc-hover-bg: var(--wave4);
  --acc-hover-text:#062b1a;
  --acc-content-bg: rgba(168,255,191,0.07);
}

[data-theme="night"]{
  --bg:#070b17; --panel:#0b1120cc; --text:#d6e0ff; --muted:#9aa7c7;
  --wave1:#88a7ff; --wave2:#6b90ff; --wave3:#5f7bdd; --wave4:#8fb3ff;

  --bg-grad1: rgba(136,167,255,0.16);
  --bg-grad2: rgba(107,144,255,0.14);
  --bg-grad3: rgba(95,123,221,0.10);

  --hud-bg: rgba(11,17,32,0.94);
  --hud-border: rgba(214,224,255,0.12);

  --acc-border: rgba(154,167,199,0.35);
  --acc-bg: rgba(11,17,32,0.9);
  --acc-hover-bg: var(--wave2);
  --acc-hover-text:#061233;
  --acc-content-bg: rgba(107,144,255,0.08);
}

[data-theme="mono"]{
  --bg:#0b0b0b; --panel:#151515cc; --text:#f0f0f0; --muted:#bdbdbd;
  --wave1:#ffffff; --wave2:#dddddd; --wave3:#cfcfcf; --wave4:#e8e8e8;

  --bg-grad1: rgba(255,255,255,0.08);
  --bg-grad2: rgba(255,255,255,0.06);
  --bg-grad3: rgba(255,255,255,0.04);

  --hud-bg: rgba(21,21,21,0.94);
  --hud-border: rgba(255,255,255,0.12);

  --acc-border: rgba(240,240,240,0.20);
  --acc-bg: rgba(21,21,21,0.92);
  --acc-hover-bg: #e8e8e8;
  --acc-hover-text:#101010;
  --acc-content-bg: rgba(255,255,255,0.06);
}

[data-theme="sunset"]{
  --bg:#1b0a0a; --panel:#2a0f0fcc; --text:#ffe8d6; --muted:#ffbfa3;
  --wave1:#ffb86b; --wave2:#ff7a7a; --wave3:#ff98c6; --wave4:#ffd08a;

  --bg-grad1: rgba(255,176,122,0.20);
  --bg-grad2: rgba(255,122,122,0.14);
  --bg-grad3: rgba(255,152,198,0.10);

  --hud-bg: rgba(42,15,15,0.92);
  --hud-border: rgba(255,232,214,0.14);

  --acc-border: rgba(255,191,163,0.35);
  --acc-bg: rgba(42,15,15,0.88);
  --acc-hover-bg: var(--wave1);
  --acc-hover-text:#2a0f0f;
  --acc-content-bg: rgba(255,176,122,0.08);
}

[data-theme="aurora"]{
  --bg:#0a0f14; --panel:#152028cc; --text:#e1ffe7; --muted:#9de0c9;
  --wave1:#50fa7b; --wave2:#69ffcf; --wave3:#bd93f9; --wave4:#88e0ff;

  --bg-grad1: rgba(80,250,123,0.16);
  --bg-grad2: rgba(189,147,249,0.14);
  --bg-grad3: rgba(136,224,255,0.10);

  --hud-bg: rgba(21,32,40,0.92);
  --hud-border: rgba(225,255,231,0.14);

  --acc-border: rgba(157,224,201,0.35);
  --acc-bg: rgba(21,32,40,0.88);
  --acc-hover-bg: var(--wave2);
  --acc-hover-text:#08231c;
  --acc-content-bg: rgba(105,255,207,0.08);
}

[data-theme="ocean"]{
  --bg:#061c24; --panel:#0a2e3acc; --text:#d6f9ff; --muted:#8ddae5;
  --wave1:#00d4ff; --wave2:#00ffa6; --wave3:#7de3ff; --wave4:#74fbd5;

  --bg-grad1: rgba(0,212,255,0.18);
  --bg-grad2: rgba(116,251,213,0.12);
  --bg-grad3: rgba(125,227,255,0.10);

  --hud-bg: rgba(10,46,58,0.92);
  --hud-border: rgba(214,249,255,0.12);

  --acc-border: rgba(141,218,229,0.35);
  --acc-bg: rgba(10,46,58,0.88);
  --acc-hover-bg: var(--wave1);
  --acc-hover-text:#02171d;
  --acc-content-bg: rgba(0,212,255,0.08);
}

[data-theme="cyberpunk"]{
  --bg:#0a0013; --panel:#1c0a2ecc; --text:#ffd6ff; --muted:#ff9de0;
  --wave1:#ff2ad4; --wave2:#00ffea; --wave3:#ff77d4; --wave4:#9d7dff;

  --bg-grad1: rgba(255,42,212,0.18);
  --bg-grad2: rgba(0,255,234,0.12);
  --bg-grad3: rgba(157,125,255,0.10);

  --hud-bg: rgba(28,10,46,0.94);
  --hud-border: rgba(255,214,255,0.12);

  --acc-border: rgba(255,157,224,0.35);
  --acc-bg: rgba(28,10,46,0.90);
  --acc-hover-bg: var(--wave2);
  --acc-hover-text:#021417;
  --acc-content-bg: rgba(255,42,212,0.08);
}

html,body{height:100%}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif;
  background: radial-gradient(1200px 800px at 70% -10%, #12203a 0%, transparent 60%), var(--bg);
  color:var(--text);
  overflow-x:hidden;
}
.wrap{display:grid;grid-template-rows:auto 1fr auto;min-height:100vh}
header{
  position:sticky;top:0;z-index:5;
  backdrop-filter:blur(10px);
  background:linear-gradient(180deg,var(--panel),transparent);
  box-shadow:var(--shadow);
}
.container{width:min(1120px,92vw);margin:0 auto;padding:16px 0}
.row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}

.brand{display:flex;align-items:center;gap:12px;font-weight:700;letter-spacing:.4px}
.logo{
  width:28px;height:28px;border-radius:8px;display:grid;place-items:center;
  background:#0b1220;box-shadow:inset 0 0 0 2px var(--accent2);
  color:var(--accent2);font-size:12px;font-weight:800
}

.panel{
  background:var(--panel);
  border:1px solid rgba(255,255,255,0.08);
  border-radius:16px;padding:14px 16px;box-shadow:var(--shadow)
}
.pill{
  font-size:12px;padding:6px 10px;border-radius:999px;
  border:1px solid rgba(255,255,255,0.12);color:var(--muted);
  display:inline-flex;align-items:center;gap:8px
}
.pill input[type="range"]{vertical-align:middle}

.small{font-size:12px;color:var(--muted)}

.btn{
  appearance:none;cursor:pointer;user-select:none;
  border:1px solid rgba(255,255,255,0.1);border-radius:12px;
  padding:10px 14px;background:#0f172acc;color:var(--text);
  font-weight:600;display:inline-flex;align-items:center;gap:8px;
  transition:transform .12s ease, background .2s ease, border-color .2s ease, box-shadow .2s ease;
  text-decoration:none; white-space:nowrap;
}
.btn:hover{transform:translateY(-1px);border-color:rgba(255,255,255,0.25)}
.btn:active{transform:translateY(0) scale(.99)}
.btn:focus-visible{outline:2px solid var(--accent);outline-offset:2px;box-shadow:0 0 0 4px rgba(157,125,255,0.25)}
.btn.success{background:linear-gradient(135deg,var(--accent2) 0%,#86ffbf 100%);border-color:transparent;color:#001d00}

/* Загрузить */
.btn.primary{
  background:linear-gradient(135deg,var(--accent) 0%,#7b5cff 100%);
  border-color:transparent;color:#0b0720
}

/* Спрятанный input:file */
input[type="file"]{
  position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden;
  clip:rect(0 0 0 0); white-space:nowrap; border:0;
}

/* Canvas */
main{
  position:relative;
  padding-bottom: var(--hud-space); /* ТЕПЕРЬ отступ под HUD действует на ВСЁ содержимое, включая FAQ/футер */
}
.hero{
  position:relative;
  min-height:540px;
  display:grid;
  place-items:center;
  overflow:hidden;
}

.wrap::after{
  content:"";
  display:block;
  height:var(--hud-space);
}

.bg-grad{
  position:absolute;inset:-40% -20% -20% -20%;
  background:
    radial-gradient(600px 400px at 20% 0%, var(--bg-grad1), transparent 60%),
    radial-gradient(800px 500px at 80% 10%, var(--bg-grad2), transparent 65%),
    radial-gradient(900px 550px at 50% 100%, var(--bg-grad3), transparent 70%);
  filter:blur(26px);animation:float 22s ease-in-out infinite alternate;pointer-events:none
}

@keyframes float{from{transform:translateY(-10px)}to{transform:translateY(10px)}}

.canvas-wrap{
  width:min(1120px,92vw);
  /* динамическое соотношение сторон из JS */
  aspect-ratio: var(--ar, 16/9);
  position:relative;
}
canvas{
  width:100%;
  height:100%;
  display:block;
  border-radius:18px;
  background:transparent;
  box-shadow:var(--shadow);
}


/* HUD — НЕ перекрывает контент (за счёт --hud-space) */
.hud{
  position:fixed; left:50%; bottom:20px; transform:translateX(-50%);
  display:flex; align-items:center; justify-content:center;
  gap:12px; padding:10px 14px;
  background:var(--hud-bg);
  border:1px solid var(--hud-border);
  border-radius:14px; box-shadow:0 6px 24px rgba(0,0,0,0.45);
  z-index:2000;

  max-width:min(1120px,94vw);
  flex-wrap:wrap;
  overflow:visible;
}
.hud > *{flex:0 0 auto; min-width: auto}

/* Themed FAQ (details/summary) */
details{
  margin:8px 0;
  border:1px solid var(--acc-border);
  border-radius:12px;
  background:var(--acc-bg);
  overflow:hidden;
  transition:border-color .2s ease, background .2s ease, box-shadow .2s ease;
}

summary{
  cursor:pointer;
  padding:12px 16px;
  font-weight:700;
  color:var(--text);
  display:flex;
  align-items:center;
  gap:10px;
  list-style:none;
}

summary::-webkit-details-marker{display:none}
summary::after{
  content:'▸';
  margin-left:auto;
  opacity:.7;
  transition:transform .2s ease, opacity .2s ease;
}

summary:hover{
  background:var(--acc-hover-bg);
  color:var(--acc-hover-text);
}

summary:focus-visible{
  outline:2px solid var(--accent);
  outline-offset:2px;
  border-radius:10px;
}

details[open] summary{
  border-bottom:1px solid var(--acc-border);
}

details[open] summary::after{
  transform:rotate(90deg);
  opacity:1;
}

details > *:not(summary){
  padding:12px 16px;
  margin:0;
  background:var(--acc-content-bg);
  color:var(--text);
}

/* Делаем под мобилки */
@media (max-width: 600px){
  .hud{justify-content:stretch; gap:10px}
  .hud .btn, .hud .pill, .hud .small{flex:1 1 auto}
  .hud .small{flex:0 0 100%; text-align:center}
}

kbd{
  display:inline-block;padding:2px 6px;border-radius:6px;
  border:1px solid rgba(255,255,255,0.18);background:rgba(255,255,255,0.06);
  font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,"Liberation Mono",monospace;font-size:12px;
}

@media (max-width: 480px){
  body{font-size:14px}
  .container{padding:12px 0}
  header .row{flex-direction:column;align-items:flex-start;gap:8px}
  .btn{justify-content:center}
}
